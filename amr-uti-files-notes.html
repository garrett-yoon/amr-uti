<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Consolas" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/309091 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Consolas;
      font-size: 14pt;
    }
  </style>
</head>
<body>
<a name="2354"/>

<div>
<span><div><ul><li><div><font style="font-size: 12pt;">run_all_rep.sh </font></div></li><ul><li><div><i><font style="font-size: 12pt;">Builds outcome models using original HP</font></i></div></li><li><div><i><font style="font-size: 12pt;">Runs train_outcome_models_eval_test_replication.sh</font></i></div></li></ul><li><div><font style="font-size: 12pt;">run_all.sh</font></div></li><ul><li><div><i><font style="font-size: 12pt;">Full end to end analysis including building outcome models, thresholding, and re-training models, thresholding on test set.</font></i></div></li><li><div><i><font style="font-size: 12pt;">Runs train_outcome_models_validation.sh</font></i></div></li><li><div><i><font style="font-size: 12pt;">Runs thresholding_validation.sh</font></i></div></li><li><div><i><font style="font-size: 12pt;">Runs train_outcome_models_eval_test.sh</font></i></div></li><li><div><i><font style="font-size: 12pt;">Runs thresholding_test.sh</font></i></div></li></ul><li><div><font style="font-size: 12pt;">experiments</font></div></li><ul><li><div><font style="font-size: 12pt;">experiment_thresholding.py</font></div></li><ul><li><div><span style="font-size: 12pt;">IF RUN BY thresholding_validation.sh</span></div></li><ul><li><div><span style="font-size: 12pt;">Creates FNR combos for antibiotics</span></div></li><li><div><span style="font-size: 12pt;">Calculates stats for all threshold combinations, stores in val_stats_by_setting.csv</span></div></li><ul><li><div><span style="font-size: 12pt;">iat_prop/broad_prop : mean IAT/Broad proportion over 20 cross validation sets (all samples)</span></div></li><li><div><span style="font-size: 12pt;">iat_prop_decision/broad_prop_decision : mean IAT/Broad proportion over 20 cross validation sets (decision cohort)</span></div></li><li><div><span style="font-size: 12pt;">iat_diff_mean/broad_diff_mean : mean IAT/broad difference rate from physician prescriptions * number of samples = mean number of samples difference that were IAT or 2nd line compared to actual prescriptions</span></div></li><li><div><span style="font-size: 12pt;">iat_diff_std/broad_diff_std : std dev of IAT/broad difference rate from physician prescriptions * number of samples = st dev of samples difference that were IAT or 2nd line compared to actual prescriptions</span></div></li><li><div><span style="font-size: 12pt;">defer_rate: mean rate of deferral (no recommendation made)</span></div></li></ul><li><div><span style="font-size: 12pt;">Calculates best outcomes for each 2nd line usage constraint, stores in best_val_outcomes_by_max_broad.csv</span></div></li><ul><li><div><span style="font-size: 12pt;">Generates 50 difference broad spectrum constraints between 1% and 50%</span></div></li><li><div><span style="font-size: 12pt;">Finds where IAT_prop is lowest given broad_prop &lt; constraint</span></div></li></ul></ul><li><div><span style="font-size: 12pt;">IF RUN BY </span><span style="font-size: 12pt;">thresholding_test.sh</span></div></li><ul><li><div><span style="font-size: 12pt;">Broad constraint is set at 10%, selects a threshold set (minimal IAT)</span></div></li><li><div><span style="font-size: 12pt;">Loads in best_val_outcomes_by_max_broad.csv</span></div></li><li><div><span style="font-size: 12pt;">Evaluates the chosen set of thresholds on the test set, creating a best_test_outcomes_by_max_broad.csv</span></div></li><ul><li><div><span style="font-size: 12pt;">One line is the set of stats</span></div></li></ul><li><div><span style="font-size: 12pt;">Creates a test_policy_df, which has each samples predicted probabilities,true labels, prescription, algorithm recommendation (NIT, SVX, CIP, LVX, defer), and final recommendation</span></div></li></ul></ul><li><div><font style="font-size: 12pt;">experiment_train_outcome_models.py</font></div></li><ul><li><div><font style="font-size: 12pt;">IF RUN BY </font><span style="font-size: 12pt;">train_outcome_models_validation.sh</span></div></li><ul><li><div><span style="font-size: 12pt;">(Only used in end to end analysis)</span></div></li><li><div><font style="font-size: 12pt;">Stores results in train_outcome_models/train_outcome_models_eval_test(_rep)/results</font></div></li><li><div><font style="font-size: 12pt;">Tunes hyperparameters for models to predict resistance to abx drug_code</font></div></li><li><div><font style="font-size: 12pt;">Trains models to predict resistance to antibiotic drug_code at the best hyperparameters setting chosen from the validation set for each model class. Returns dictionary model mapping class to validation AUC for the class.</font></div></li><li><div><font style="font-size: 12pt;">Find best model for each abx based on validation AUC</font></div></li><li><div><font style="font-size: 12pt;">Creates hyperparameters.json, val_aucs.json in results path</font></div></li><li><div><span style="font-size: 12pt;">Creates best_models.json</span></div></li><li><div><font style="font-size: 12pt;">Generates predicted probabilities of resistance for multiple train/validation splits across all antibiotics using the optimal tune hyperparameters and model classes</font></div></li><li><div><font style="font-size: 12pt;">Creates val_predictions.csv in results path</font></div></li></ul><li><div><font style="font-size: 12pt;">IF RUN BY </font><span style="font-size: 12pt;">train_outcome_models_eval_test_replication.sh or train_outcome_models_eval_test.sh</span></div></li></ul></ul><ul><ul><ul><li><div><span style="font-size: 12pt;">(Used in both original hyperparameters and end to end analysis pipelines)</span></div></li><li><div><font style="font-size: 12pt;">Loads hyperparmaters.json and best_models.json generated in train_outcome_models_validation/results (in end to end case) or in models/replication_hyperparameters (in original hyperparameters case)</font></div></li><li><div><font style="font-size: 12pt;">Constructs train/validation predictions to be saved as &quot;test_predictions.csv&quot; in results folder</font></div></li></ul></ul><li><div><font style="font-size: 12pt;">experiment_results</font></div></li><ul><li><div><font style="font-size: 12pt;">train_outcome_models</font></div></li><ul><li><div><font style="font-size: 12pt;">train_outcome_models_eval_test</font></div></li><li><div><font style="font-size: 12pt;">train_outcome_models_eval_test_rep</font></div></li><li><div><font style="font-size: 12pt;">train_outcome_models_validation</font></div></li></ul><li><div><font style="font-size: 12pt;">thresholding</font></div></li><ul><li><div><font style="font-size: 12pt;">thresholding_eval_test</font></div></li><li><div><font style="font-size: 12pt;">thresholding_validation</font></div></li></ul></ul><li><div><font style="font-size: 12pt;">scripts</font></div></li><ul><li><div><font style="font-size: 12pt;">eval_test_scripts</font></div></li><ul><li><div><font style="font-size: 12pt;">train_outcome_models_eval_test_replication.sh</font></div></li><ul><li><div><font style="font-size: 12pt;">Runs experiment_train_outcome_models.py using best_models.json, hyperparameters.json</font></div></li><li><div><span style="font-size: 12pt;">Only script run in the original hyperparameter pipeline</span></div></li></ul><li><div><font style="font-size: 12pt;">thresholding_test.sh</font></div></li><ul><li><div><span style="font-size: 12pt;">Runs experiment_thresholding.py, as name 'thresholding_eval_test'</span></div></li><li><div><span style="font-size: 12pt;">--eval_test, --save_policy = True</span></div></li><li><div><span style="font-size: 12pt;">Creates best_test_outcomes_by_max_broad.csv, test_policy_df.csv</span></div></li></ul><li><div><font style="font-size: 12pt;">train_outcome_models_eval_test.sh</font></div></li><ul><li><div><span style="font-size: 12pt;">Runs experiment_train_outcome_models.py using best_models.json, hyperparameters.json from train_outcome_models_validation.sh</span></div></li></ul></ul></ul></ul><ul><ul><li><div><font style="font-size: 12pt;">validation_scripts</font></div></li><ul><li><div><font style="font-size: 12pt;">train_outcome_models_validation.sh</font></div></li><ul><li><div><span style="font-size: 12pt;">Runs experiment_train_outcome_models.py as name &quot;train_outcome_models_validation&quot;</span></div></li></ul><li><div><font style="font-size: 12pt;">thresholding_validation.sh</font></div></li><ul><li><div><span style="font-size: 12pt;">Runs experiment_thresholding.py, as name &quot;thresholding_validation&quot;</span></div></li><li><div><span style="font-size: 12pt;">Creates best_val_outcomes_by_max_broad.csv, val_stats_by_setting.csv</span></div></li></ul></ul></ul></ul></ul><div><br/></div></div></span>
</div></body></html> 